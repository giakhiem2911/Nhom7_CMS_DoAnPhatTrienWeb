<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title th:text="${menu.maMenu != null} ? 'Sửa Menu' : 'Thêm Menu'">Thêm/Sửa Menu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body th:replace="~{layout :: layout}">
    <div th:fragment="content" class="p-4">
        <h2 class="mb-4" th:text="${menu.maMenu != null} ? 'Sửa Menu' : 'Thêm Menu'"></h2>
        <form th:action="@{/menu/save}" th:object="${menu}" method="post" class="needs-validation" novalidate>
            <input type="hidden" th:field="*{maMenu}" />
            <div class="mb-3">
                <label for="maMenu" class="form-label">Mã Menu</label>
                <input type="text" id="maMenu" th:field="*{maMenu}" class="form-control" 
                       th:readonly="${menu.maMenu != null}" required 
                       placeholder="Nhập mã menu (ví dụ: M001)" />
                <div class="invalid-feedback">Vui lòng nhập mã menu.</div>
            </div>
            <div class="mb-3">
                <label for="ten" class="form-label">Tên Menu</label>
                <input type="text" id="ten" th:field="*{ten}" class="form-control" required 
                       placeholder="Nhập tên menu" />
                <div class="invalid-feedback">Vui lòng nhập tên menu.</div>
            </div>
            <div class="mb-3">
                <label for="maNguoiDung" class="form-label">Người Tạo</label>
                <select id="maNguoiDung" th:field="*{maNguoiDung}" class="form-select" required>
                    <option value="" disabled th:selected="${menu.maNguoiDung == null}">Chọn người tạo</option>
                    <option th:each="nguoiDung : ${nguoiDungs}"
                            th:value="${nguoiDung.maNguoiDung}"
                            th:text="${nguoiDung.hoTen}"
                            th:selected="${nguoiDung.maNguoiDung == menu.maNguoiDung}">
                    </option>
                </select>
                <div class="invalid-feedback">Vui lòng chọn người tạo.</div>
            </div>
            <div class="mb-4">
                <label for="thuTuHienThi" class="form-label">Thứ Tự Hiển Thị</label>
                <input type="number" id="thuTuHienThi" th:field="*{thuTuHienThi}" class="form-control" min="1" required
                       placeholder="Nhập thứ tự hiển thị (ví dụ: 1)" />
                <div class="invalid-feedback">Vui lòng nhập thứ tự hiển thị (>=1).</div>
            </div>
            <button type="submit" class="btn btn-success px-4">Lưu</button>
            <a href="/menu" class="btn btn-secondary ms-3 px-4">Quay lại</a>
        </form>
    </div>

    <script>
        (() => {
            'use strict'
            const forms = document.querySelectorAll('.needs-validation')
            Array.from(forms).forEach(form => {
                form.addEventListener('submit', event => {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    form.classList.add('was-validated')
                }, false)
            })
        })()
    </script>
</body>
</html>
